# Example

> *Example with generation of test cases and test data, but without the combination of test scenarios and states.*

Translations: [Portugu√™s](example-pt.md) üåé

## 1. Writing a specification file

The following file specifies a simple *Login* feature. Its `Feature` describe the desired behavior as a [User Story](https://en.wikipedia.org/wiki/User_story). Its `Scenario` define a high-level, *business-oriented* description of a usage scenario, using the [Given-When-Then](https://www.martinfowler.com/bliki/GivenWhenThen.html) (GWT) syntax. A `Feature` may have as many `Scenarios` as it needs. Features and Scenarios **are not used to generate test cases** in Concordia Language. Thus, you are free to use them to express your business needs.

*login.feature* :
```gherkin
Feature: Login
  As a user
  I would like to authenticate myself
  In order to access the application

Scenario: Successful login
  Given that I can see the login screen
  When I enter with valid credentials
  Then I can access the application's main screen
```

Concordia Language uses a `Variant` to express a possible interaction between a *user* and the *system* in order to complete a (business) `Scenario`. A `Scenario` may have as many `Variants` it needs. A `Variant` also follows the [GWT](https://www.martinfowler.com/bliki/GivenWhenThen.html) syntax and always uses the word "`I`" to represent a *user* or *user role*.

Let's add a `Variant` that expects a interaction with a *web application* and uses fixed values.

```gherkin
Feature: Login
  As a user
  I would like to authenticate myself
  In order to access the application

Scenario: Successful login
  Given that I can see the login screen
  When I enter with valid credentials
  Then I can access the application's main screen

  Variant: Successful login with valid credentials
    Given that I see the url "/login"
    When I fill <#username> with "john.doe"
      and I fill <#password> with "123456"
      and I click on <#ok>
    Then I see "Welcome"
```

The `Variant`'s sentences has [actions](actions.md) that will be transformed to code by a [plug-in](../plugins/README.md).

```gherkin
Feature: Login
  As a user
  I would like to authenticate myself
  In order to access the application

Scenario: Successful login
  Given that I can see the login screen
  When I enter with valid credentials
  Then I can access the application's main screen

  Variant: Successful login with valid credentials
    Given that I am in the [Login Screen]
    When I fill {Username}
      And I fill {Password}
      And I click on {OK}
    Then I see "Welcome"
      And I have ~user is logged in~

Constants:
  - "Login Screen" is "http://localhost/login"

Table: Users
  | username | password  |
  | bob      | 123456    |
  | alice    | 4l1c3pass |

UI Element: Username
  - value comes from "SELECT username FROM [Users]"
    Otherwise I must see "Invalid username"
  - required is true

UI Element: Password
  - value comes from "SELECT password FROM [Users] WHERE username = {Username}"
    Otherwise I must see "Invalid password"
  - required is true

UI Element: OK
  - type is button
```

## 2. Generate and execute tests

Concordia can generate [Test Cases](https://en.wikipedia.org/wiki/Test_case) and test scripts (source code).

### Test Cases

- Always written in *Concordia Language*
- Declared in `.testcase` files
- Generated from `.feature` files

Test Cases generated from Concordia will always have the same name of the `.feature` file. For instance, `login.feature` will produce `login.testcase`.

You can also write your own `.testcase` files, if it's desired to write additional test cases. However, **we recommend you to create them in files whose names are different from the feature files**, since they could be overwriten otherwise.

### Test Scripts

- Programming language and testing framework depend on the used plug-in
- Generated from Test Cases

Test Scripts generated from Concordia will usually have the same name of the `.feature` file, and will be saved under a subdirectory `test`. For instance `login.testcase` can produce `test/login.js`, whether the plugin for CodeceptJS is used.

You can also write your own Test Scripts. We **recommend you to create them in files whose names are different from those generated by Concordia**, since they could be overwritten otherwise.

### Generation without execution

The following command will generate test cases and test scripts for the framework CodeceptJS, without executing the test scripts.

```console
$ concordia --seed="hello world" --plugin=codeceptjs --no-run --no-result
```

The parameter `seed` is the [random seed](https://en.wikipedia.org/wiki/Random_seed). When the seed is always the same, so is the random values generated by Concordia. Whether it is not informed, Concordia will generate one. Different seeds may raise the chances of discovering new defects, since values and selected paths may vary from execution to execution.

In our example, we inform the seed to get always the same results.

Parameters `no-run` and `no-result` avoid running the test scripts and getting execution results.

### Generation and execution

Make sure that the test server is up. Whether is not active, just run the following:

```console
$ concordia --plugin-serve=codeceptjs
```
The test server will wait for tests. When you wish to finish it later, just type `Ctrl + C`.

Then, let's generate and execute tests:

```console
$ concordia --seed="hello world" --plugin=codeceptjs
```

### Execution without generation

This will not generate test cases or test scripts, but it will execute them and get their results:
```console
$ concordia --plugin=codeceptjs --no-test-case --no-script
```

## Results

`login.testcase`:

```gherkin
# Generated with ‚ù§ by Concordia
#
# THIS IS A GENERATED FILE - MODIFICATIONS CAN BE LOST !

import "login-en.feature"

@generated
@scenario(1)
@variant(1)
Test case: Successful login with valid credentials - 1
  Given that I am in the "http://localhost/login"  # [Login Screen]
  When i fill <username> with "*RM)O,"  # invalid: inexistent element
    And i fill <password> with ""  # valid: last element
    And I click on <ok>  # {OK}
  Then I must see "Invalid username"  # from <username>

@generated
@scenario(1)
@variant(1)
Test case: Successful login with valid credentials - 2
  Given that I am in the "http://localhost/login"  # [Login Screen]
  When i fill <username> with "bob"  # valid: filled
    And i fill <password> with -8655972838932479  # invalid: inexistent element
    And I click on <ok>  # {OK}
  Then I must see "Invalid password"  # from <password>

@generated
@scenario(1)
@variant(1)
Test case: Successful login with valid credentials - 3
  Given that I am in the "http://localhost/login"  # [Login Screen]
  When i fill <username> with "alice"  # valid: random element
    And i fill <password> with "4l1c3pass"  # valid: random element
    And I click on <ok>  # {OK}
  Then I see "Welcome"

@generated
@scenario(1)
@variant(1)
Test case: Successful login with valid credentials - 4
  Given that I am in the "http://localhost/login"  # [Login Screen]
  When i fill <username> with "alice"  # valid: last element
    And i fill <password> with "4l1c3pass"  # valid: filled
    And I click on <ok>  # {OK}
  Then I see "Welcome"

@generated
@fail
@scenario(1)
@variant(1)
Test case: Successful login with valid credentials - 5
  Given that I am in the "http://localhost/login"  # [Login Screen]
  When i fill <username> with ""  # invalid: not filled
    And i fill <password> with ""  # invalid: not filled
    And I click on <ok>  # {OK}
  Then I see "Welcome"

@generated
@scenario(1)
@variant(1)
Test case: Successful login with valid credentials - 6
  Given that I am in the "http://localhost/login"  # [Login Screen]
  When i fill <username> with "bob"  # valid: first element
    And i fill <password> with 123456  # valid: first element
    And I click on <ok>  # {OK}
  Then I see "Welcome"
```

`test/login.js`:

```javascript
// Generated with ‚ù§ by Concordia
// source: c:\code\tmp\concordia-test-pt\login-en.testcase
//
// THIS IS A GENERATED FILE - MODIFICATIONS CAN BE LOST !

Feature("Login");

Scenario("Successful login | Successful login with valid credentials - 1", (I) => {
    I.amOnPage("http://localhost/login"); // (61,5)  [Login Screen]
    I.fillField("username", "*RMO,"); // (11,5)  invalid: inexistent element
    I.fillField("password", ""); // (12,7)  valid: last element
    I.click("ok"); // (64,7)  {OK}
    I.see("Invalid username"); // (14,5)  from <username>
});

Scenario("Successful login | Successful login with valid credentials - 2", (I) => {
    I.amOnPage("http://localhost/login"); // (61,5)  [Login Screen]
    I.fillField("username", "bob"); // (21,5)  valid: filled
    I.fillField("password", "-8655972838932479"); // (22,7)  invalid: inexistent element
    I.click("ok"); // (64,7)  {OK}
    I.see("Invalid password"); // (24,5)  from <password>
});

Scenario("Successful login | Successful login with valid credentials - 3", (I) => {
    I.amOnPage("http://localhost/login"); // (61,5)  [Login Screen]
    I.fillField("username", "alice"); // (31,5)  valid: random element
    I.fillField("password", "4l1c3pass"); // (32,7)  valid: random element
    I.click("ok"); // (64,7)  {OK}
    I.see("Welcome"); // (65,5)
});

Scenario("Successful login | Successful login with valid credentials - 4", (I) => {
    I.amOnPage("http://localhost/login"); // (61,5)  [Login Screen]
    I.fillField("username", "alice"); // (41,5)  valid: last element
    I.fillField("password", "4l1c3pass"); // (42,7)  valid: filled
    I.click("ok"); // (64,7)  {OK}
    I.see("Welcome"); // (65,5)
});

Scenario("Successful login | Successful login with valid credentials - 5", (I) => {
    I.amOnPage("http://localhost/login"); // (61,5)  [Login Screen]
    I.fillField("username", ""); // (52,5)  invalid: not filled
    I.fillField("password", ""); // (53,7)  invalid: not filled
    I.click("ok"); // (64,7)  {OK}
    I.see("Welcome"); // (65,5)
});

Scenario("Successful login | Successful login with valid credentials - 6", (I) => {
    I.amOnPage("http://localhost/login"); // (61,5)  [Login Screen]
    I.fillField("username", "bob"); // (62,5)  valid: first element
    I.fillField("password", "123456"); // (63,7)  valid: first element
    I.click("ok"); // (64,7)  {OK}
    I.see("Welcome"); // (65,5)
});
```

## Result analysis

Whether you ran the test scripts above, you probably saw they fail. That's because they didn't find a web application running at `http://localhost/login` or because the application was found but it did not match the expected behavior. You may adapt your application and run the tests again.

Concordia shows a report that indicates the failures' locations. They help you to decide if a failure was caused by the application under test (*e.g.*, it did not behave as expected) or because of the requirements specification (*e.g.*, it is outdated in relation to the application).

Now keeping your specification updated has a new clear benefit: you can use it to generate tests and discover existing defects in your application!


## See also

- [Language syntax](language/en.md)
- [Available actions](actions.md)